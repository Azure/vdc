{
    "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "auditEffect": {
            "type": "string",
            "defaultValue": "Audit",
            "metadata": {
                "description": "Required. Policy effect."
            }
        },
        "auditIfNotExistsEffect": {
            "type": "string",
            "defaultValue": "AuditIfNotExists",
            "metadata": {
                "description": "Required. Policy effect."
            }
        },
        "workspaceId": {
            "type": "string",
            "metadata": {
                "description": "Required. WorkspaceId or CustomerId value of OMS. This value is referenced in OMS VM Extension"
            }
        },
        "location": {
            "type": "string",
            "metadata": {
                "description": "Required. Location used as part of the Policy assignment."
            }
        },
        "listOfResourceTypesWithDiagnosticLogsEnabled": {
            "type": "array",
            "defaultValue": [
                "Microsoft.AnalysisServices/servers",
                "Microsoft.ApiManagement/service",
                "Microsoft.Network/applicationGateways",
                "Microsoft.Automation/automationAccounts",
                "Microsoft.ContainerInstance/containerGroups",
                "Microsoft.ContainerRegistry/registries",
                "Microsoft.ContainerService/managedClusters",
                "Microsoft.Batch/batchAccounts",
                "Microsoft.Cdn/profiles/endpoints",
                "Microsoft.CognitiveServices/accounts",
                "Microsoft.DocumentDB/databaseAccounts",
                "Microsoft.DataFactory/factories",
                "Microsoft.DataLakeAnalytics/accounts",
                "Microsoft.DataLakeStore/accounts",
                "Microsoft.EventGrid/eventSubscriptions",
                "Microsoft.EventGrid/topics",
                "Microsoft.EventHub/namespaces",
                "Microsoft.Network/expressRouteCircuits",
                "Microsoft.Network/azureFirewalls",
                "Microsoft.HDInsight/clusters",
                "Microsoft.Devices/IotHubs",
                "Microsoft.KeyVault/vaults",
                "Microsoft.Network/loadBalancers",
                "Microsoft.Logic/integrationAccounts",
                "Microsoft.Logic/workflows",
                "Microsoft.DBforMySQL/servers",
                "Microsoft.Network/networkInterfaces",
                "Microsoft.Network/networkSecurityGroups",
                "Microsoft.DBforPostgreSQL/servers",
                "Microsoft.PowerBIDedicated/capacities",
                "Microsoft.Network/publicIPAddresses",
                "Microsoft.RecoveryServices/vaults",
                "Microsoft.Cache/redis",
                "Microsoft.Relay/namespaces",
                "Microsoft.Search/searchServices",
                "Microsoft.ServiceBus/namespaces",
                "Microsoft.SignalRService/SignalR",
                "Microsoft.Sql/servers/databases",
                "Microsoft.Sql/servers/elasticPools",
                "Microsoft.StreamAnalytics/streamingjobs",
                "Microsoft.TimeSeriesInsights/environments",
                "Microsoft.Network/trafficManagerProfiles",
                "Microsoft.Compute/virtualMachines",
                "Microsoft.Compute/virtualMachineScaleSets",
                "Microsoft.Network/virtualNetworks",
                "Microsoft.Network/virtualNetworkGateways"
            ],
            "metadata": {
                "displayName": "Optional. Resource types to audit diagnostic logs (Policy: Blueprint initiative for ISO 27001)"
            }
        },
        "listOfMembersToExcludeFromWindowsVMAdministratorsGroup": {
            "type": "string",
            "defaultValue": "none",
            "metadata": {
                "displayName": "Members to exclude",
                "description": "Optional. A semicolon-separated list of members that should be excluded in the Administrators local group. Ex: Administrator; myUser1; myUser2"
            }
        },
        "listOfMembersToIncludeInWindowsVMAdministratorsGroup": {
            "type": "string",
            "defaultValue": "none",
            "metadata": {
                "displayName": "Members to include",
                "description": "Optional. A semicolon-separated list of members that should be included in the Administrators local group. Ex: Administrator; myUser1; myUser2"
            }
        }
    },
    "variables": {},
    "resources": [
        {
            "name": "[guid('aa633080-8b72-40c4-a2d7-d00c03e80bed')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "MFA should be enabled on accounts with owner permissions on your subscription",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('e3576e28-8b17-4677-84c3-db2990658d64')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "MFA should be enabled on accounts with read permissions on your subscription",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('9297c21d-2ed6-4474-b48f-163f75654ce3')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "MFA should be enabled accounts with write permissions on your subscription",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('c3f317a7-a95c-4547-b7e7-11017ebdf2fe')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "System updates on virtual machine scale sets should be installed",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c3f317a7-a95c-4547-b7e7-11017ebdf2fe",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('5744710e-cc2f-4ee8-8809-3b11e89f4bc9')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "CORS should not allow every resource to access your Web Application",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('6b1cbf55-e8b6-442f-ba4c-7246b6381474')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Deprecated accounts should be removed from your subscription",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('ebb62a0c-3560-49e1-89ed-27e074e9f8ad')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Deprecated accounts with owner permissions should be removed from your subscription",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('f8456c1c-aa66-4dfb-861a-25d127b775c9')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "External accounts with owner permissions should be removed from your subscription",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('5f76cf89-fbf2-47fd-a3f4-b891fa780b60')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "External accounts with read permissions should be removed from your subscription",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('5c607a2e-c700-4744-8254-d77e7c9eb5e4')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "External accounts with write permissions should be removed from your subscription",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('5df82f4f-773a-4a2d-97a2-422a806f1a55')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Function App should only be accessible over HTTPS",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('2fde8a98-6892-426a-83ba-050e640c0ce0')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Web Application should only be accessible over HTTPS",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('c85538c1-b527-4ce4-bdb4-1dabcb3fd90d')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "API App should only be accessible over HTTPS",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('32133ab0-ee4b-4b44-98d6-042180979d50')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "\"[Preview]: Audit Log Analytics Agent Deployment - VM Image (OS) unlisted",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "\"[Preview]: Audit Log Analytics Agent Deployment in VMSS - VM Image (OS) unlisted",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('f47b5582-33ec-4c5c-87c0-b010a6b2e917')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "\"[Preview]: Audit Log Analytics Workspace for VM - Report Mismatch",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "logAnalyticsWorkspaceId": {
                        "value": "[parameters('workspaceId')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('4f11b553-d42e-4e3a-89be-32ca364cad4c')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "A maximum of 3 owners should be designated for your subscription",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('09024ccc-0c5f-475e-9457-b7c0d9ed487b')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "There should be more than one owner assigned to your subscription",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Vulnerabilities in security configuration on your virtual machine scale sets should be remediated",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('0e60b895-3786-45da-8377-9c6b4b6ac5f9')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Remote debugging should be turned off for Function App",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('cb510bfd-1cba-4d9f-a230-cb0976f4bb71')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Remote debugging should be turned off for Web Application",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('e9c8d085-d9cc-4b17-9cdc-059f1f01f19e')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Remote debugging should be turned off for API App",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e9c8d085-d9cc-4b17-9cdc-059f1f01f19e",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('a7aca53f-2ed4-4466-a25e-0b45ade68efd')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "DDoS Protection Standard should be enabled",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('2d67222d-05fd-4526-a171-2ee132ad9e83')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "\"[Preview]: Audit Linux VMs that allow remote connections from accounts without passwords",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('c40c9087-1981-4e73-9f53-39743eda9d05')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "\"[Preview]: Audit Linux VMs that have accounts without passwords",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('b18175dd-c599-4c64-83ba-bb018a06d35b')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "\"[Preview]: Audit Linux VMs that do not have the passwd file permissions set to 0644",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('cdbf72d9-ac9c-4026-8a3a-491a5ac59293')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "\"[Preview]: Audit Windows VMs that allow re-use of the previous 24 passwords",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('24dde96d-f0b1-425e-884f-4a1421e2dcdc')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "\"[Preview]: Audit Windows VMs that do not have a maximum password age of 70 days",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('5aa11bbc-5c76-4302-80e5-aba46a4282e7')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "\"[Preview]: Audit Windows VMs that do not have a minimum password age of 1 day",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('f48b2913-1dc5-4834-8c72-ccc1dfd819bb')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "\"[Preview]: Audit Windows VMs that do not have the password complexity setting enabled",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('5aebc8d1-020d-4037-89a0-02043a7524ec')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "\"[Preview]: Audit Windows VMs that do not restrict the minimum password length to 14 characters",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('2d60d3b7-aa10-454c-88a8-de39d99d17c6')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "\"[Preview]: Audit Windows VMs that do not store passwords using reversible encryption",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('26a828e1-e88f-464e-bbb3-c134a282b9de')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Endpoint protection solution should be installed on virtual machine scale sets",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/26a828e1-e88f-464e-bbb3-c134a282b9de",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('ec49586f-4939-402d-a29e-6ff502b20592')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "identity": {
                "type": "SystemAssigned"
            },
            "properties": {
                "displayName": "\"[Preview]: Deploy requirements to audit Linux VMs that allow remote connections from accounts without passwords",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('3470477a-b35a-49db-aca5-1073d04524fe')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "identity": {
                "type": "SystemAssigned"
            },
            "properties": {
                "displayName": "\"[Preview]: Deploy requirements to audit Linux VMs that have accounts without passwords",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('f19aa1c1-6b91-4c27-ae6a-970279f03db9')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "identity": {
                "type": "SystemAssigned"
            },
            "properties": {
                "displayName": "\"[Preview]: Deploy requirements to audit Linux VMs that do not have the passwd file permissions set to 0644",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('726671ac-c4de-4908-8c7d-6043ae62e3b6')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "identity": {
                "type": "SystemAssigned"
            },
            "properties": {
                "displayName": "\"[Preview]: Deploy requirements to audit Windows VMs that allow re-use of the previous 24 passwords",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('356a906e-05e5-4625-8729-90771e0ee934')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "identity": {
                "type": "SystemAssigned"
            },
            "properties": {
                "displayName": "\"[Preview]: Deploy requirements to audit Windows VMs that do not have a maximum password age of 70 days",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('16390df4-2f73-4b42-af13-c801066763df')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "identity": {
                "type": "SystemAssigned"
            },
            "properties": {
                "displayName": "\"[Preview]: Deploy requirements to audit Windows VMs that do not have a minimum password age of 1 day",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "identity": {
                "type": "SystemAssigned"
            },
            "properties": {
                "displayName": "\"[Preview]: Deploy requirements to audit Windows VMs that do not have a minimum password age of 1 day",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('23020aa6-1135-4be2-bae2-149982b06eca')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "identity": {
                "type": "SystemAssigned"
            },
            "properties": {
                "displayName": "\"[Preview]: Deploy requirements to audit Windows VMs that do not restrict the minimum password length to 14 characters",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('8ff0b18b-262e-4512-857a-48ad0aeb9a78')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "identity": {
                "type": "SystemAssigned"
            },
            "properties": {
                "displayName": "\"[Preview]: Deploy requirements to audit Windows VMs that do not store passwords using reversible encryption",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('08e6af2d-db70-460a-bfe9-d5bd474ba9d6')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Network Security Group Rules for Internet facing virtual machines should be hardened",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/08e6af2d-db70-460a-bfe9-d5bd474ba9d6",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('af6cd1bd-1635-48cb-bde7-5b15693900b9')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Monitor missing Endpoint Protection in Azure Security Center",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('86b3d65f-7626-441e-b690-81a8b71cff60')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "System updates should be installed on your machines",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Vulnerabilities in security configuration on your machines should be remediated",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('47a6b606-51aa-4496-8bb7-64b11cf66adc')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Adaptive Application Controls should be enabled on virtual machines",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('b0f33259-77d7-4c9e-aac6-3aabcfae693c')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Just-In-Time network access control should be applied on virtual machines",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('feedbf84-6b99-488c-acc2-71c829aa5ffc')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Vulnerabilities on your SQL databases should be remediated",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('af8051bf-258b-44e2-a2bf-165330459f9d')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Monitor unaudited SQL servers in Azure Security Center",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('a8bef009-a5c9-4d0f-90d7-6018734e8a16')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Monitor unencrypted SQL databases in Azure Security Center",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('0961003e-5a0a-4549-abde-af6a37f2724d')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Disk encryption should be applied on virtual machines",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('9daedab3-fb2d-461e-b861-71790eead4f6')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Access through Internet facing endpoint should be restricted",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('760a85ff-6162-42b3-8d70-698e268f648c')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Vulnerabilities should be remediated by a Vulnerability Assessment solution",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('7f89b1eb-583c-429a-8828-af049802c1d9')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Audit diagnostic setting",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "listOfResourceTypes": {
                        "value": "[parameters('listOfResourceTypesWithDiagnosticLogsEnabled')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('22bee202-a82f-4305-9a2a-6d7f44d4dedb')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Only secure connections to your Redis Cache should be enabled",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('1f314764-cb73-4fc9-b863-8eca98ac36e9')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "An Azure Active Directory administrator should be provisioned for SQL servers",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('404c3081-a854-4457-ae30-26a93ef643f9')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Secure transfer to storage accounts should be enabled",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Advanced data security should be enabled on your managed instances",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Audit SQL server level Auditing settings",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Advanced data security should be enabled on your SQL servers",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('bde62c94-ccca-4821-a815-92c1d31a76de')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Audit Windows VMs in which the Administrators group contains any of the specified members",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bde62c94-ccca-4821-a815-92c1d31a76de",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('f3b44e5d-1456-475f-9c67-c66c4618e85a')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Audit Windows VMs in which the Administrators group does not contain all of the specified members",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f3b44e5d-1456-475f-9c67-c66c4618e85a",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('60ffe3e2-4604-4460-8f22-0f1da058266c')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Audit Windows web servers that are not using secure communication protocols",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('17k78e20-9358-41c9-923c-fb736d382a12')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Transparent Data Encryption on SQL databases should be enabled",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditIfNotExistsEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('34c877ad-507e-4c82-993e-3452a6e0ad3c')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Audit unrestricted network access to storage accounts",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('b54ed75b-3e1a-44ac-a333-05ba39b99ff0')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Service Fabric clusters should only use Azure Active Directory for client authentication",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('a451c1ef-c6ca-483d-87ed-f49761e3ffb5')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Audit usage of custom RBAC rules",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "effect": {
                        "value": "[parameters('auditEffect')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "properties": {
                "displayName": "Audit virtual machines without disaster recovery configured",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        },
        {
            "name": "[guid('144f1397-32f9-4598-8c88-118decc3ccba')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "identity": {
                "type": "SystemAssigned"
            },
            "properties": {
                "displayName": "Deploy requirements to audit Windows VMs in which the Administrators group contains any of the specified members",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/144f1397-32f9-4598-8c88-118decc3ccba",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "MembersToExclude": {
                        "value": "[parameters('listOfMembersToExcludeFromWindowsVMAdministratorsGroup')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('93507a81-10a4-4af0-9ee2-34cf25a96e98')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "identity": {
                "type": "SystemAssigned"
            },
            "properties": {
                "displayName": "Deploy requirements to audit Windows VMs in which the Administrators group does not contain all of the specified members",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/93507a81-10a4-4af0-9ee2-34cf25a96e98",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {
                    "MembersToInclude": {
                        "value": "[parameters('listOfMembersToIncludeInWindowsVMAdministratorsGroup')]"
                    }
                },
                "metadata": {}
            }
        },
        {
            "name": "[guid('b2fc8f91-866d-4434-9089-5ebfe38d6fd8')]",
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2018-05-01",
            "location": "[parameters('location')]",
            "identity": {
                "type": "SystemAssigned"
            },
            "properties": {
                "displayName": "Deploy requirements to audit Windows web servers that are not using secure communication protocols",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8",
                "scope": "[subscription().id]",
                "notScopes": [],
                "parameters": {},
                "metadata": {}
            }
        }
    ],
    "outputs": {}
}